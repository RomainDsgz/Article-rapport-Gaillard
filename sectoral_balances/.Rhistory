myvars <- c("year", "code", "value")
df <- df[myvars]
# Long to wide
dfw <- spread (df,
key = code,
value = value)
# rename codes
dfw <- rename(dfw, UIGT = "CHE.1.0.0.0.UIGT")
dfw <- rename(dfw, UBLC = "CHE.1.0.0.0.UBLC")
dfw <- rename(dfw, UBLH = "CHE.1.0.0.0.UBLH")
dfw <- rename(dfw, USGP = "CHE.1.0.0.0.USGP")
dfw <- rename(dfw, OIST = "CHE.1.0.0.0.OIST")
dfw <- rename(dfw, UKTGT = "CHE.1.0.0.0.UKTGT")
dfw <- rename(dfw, URTG = "CHE.1.0.0.0.URTG")
dfw <- rename(dfw, UUTG = "CHE.1.0.0.0.UUTG")
dfw <- rename(dfw, UBLG = "CHE.1.0.0.0.UBLG")
dfw <- rename(dfw, UXGS = "CHE.1.0.0.0.UXGS")
dfw <- rename(dfw, UMGS = "CHE.1.0.0.0.UMGS")
dfw <- rename(dfw, UBLA = "CHE.1.0.0.0.UBLA")
dfw <- rename(dfw, UVGN = "CHE.1.0.0.0.UVGN")
#Now that the data is ready, we can now determine the macroeconomic sectoral balances.
# (S - I)+ (T - G) + (- CAB) ??? 0
## Public Sector can be found via two methods:
dfw$pub <- dfw$URTG - dfw$UUTG # Revenues - Expenses
# Or use Net lending - Net borrowing of public sector (UBLG)
dfw$pub <- dfw$UBLG
## Rest of the World
# According to Mitchell, Wray and Watts (2019), CAB = Exports - Imports + Foreign Net Income
# Note that row_bal is negative
dfw$row <- dfw$UBLA  * -1
dfw$row
# Note that the sign of pub_bal is inversed, since the deficit of the public sector is the surplus of the private sector
dfw$priv <- (dfw$pub *-1) - dfw$row
# Now that we have all balances, we can check the equality (S - I)+ (T - G) + (- CAB) ??? 0
dfw$bal <- dfw$priv + dfw$pub + dfw$row
dfw$bal
# Now we can calculate the share (in % of GNI)
dfw$priv_bal <- (dfw$priv/dfw$UVGN)*100
dfw$pub_bal <- (dfw$pub/dfw$UVGN)*100
dfw$row_bal <- (dfw$row/dfw$UVGN) *100
dfw$balances <- dfw$priv_bal + dfw$pub_bal + dfw$row_bal
dfw$balances
# Prepare the data for plotting for 3 sectors
melted_df <- dfw %>%
select(year, priv_bal, pub_bal, row_bal) %>%
gather(key = "variable", value = "value", -year)
colors3 <- c("indianred3", "chartreuse4", "turquoise3")
plot_3sectors <- ggplot() +
geom_bar(data = subset(melted_df, year >= 1995 & year<=2022), aes(x = year, y = value, fill = variable), stat = "identity") +
scale_fill_manual(values = colors3,
labels = c("Private sector", "Public Sector", "Rest of the World")) +
labs(x = "Year", y = "Net lending - Net borrowing", fill = "Balances") +
theme_minimal() +
#theme(plot.background = element_rect(fill = "white")) +
scale_x_continuous(breaks = seq(1995, 2022, by = 5)) +
theme(legend.position = "bottom") +
guides(fill = guide_legend(nrow=1)) +
labs(title = "Sectoral balances",
subtitle = "Switzerland, 1995-2022",
caption = "Source: AMECO")
print(plot_3sectors)
# Save prepared data
save(ameco, file = "ameco.RData",
compress = "xz")
# Load packages for analysis
library(ggplot2)
library(reshape2)
# Load data
load("path/sectoral_balances/ameco.RData")
# Extract data for Switzerland (CHE)
ch <- subset(ameco, country == "Switzerland")
UBLC <- subset(ch, code == "CHE.1.0.0.0.UBLC")
UBLH <- subset(ch, code == "CHE.1.0.0.0.UBLH")
URTG <- subset(ch, code == "CHE.1.0.0.0.URTG")
UUTG <- subset(ch, code == "CHE.1.0.0.0.UUTG")
UBLG <- subset(ch, code == "CHE.1.0.0.0.UBLG")
UXGS <- subset(ch, code == "CHE.1.0.0.0.UXGS")
UMGS <- subset(ch, code == "CHE.1.0.0.0.UMGS")
UBLA <- subset(ch, code == "CHE.1.0.0.0.UBLA")
UVGN <- subset(ch, code == "CHE.1.0.0.0.UVGN")
# Merge them into one dataframe
df <- rbind(UBLC, UBLH,URTG, UUTG, UBLG, UXGS, UMGS, UBLA, UVGN)
# Select vars
myvars <- c("year", "code", "value")
df <- df[myvars]
# Long to wide
dfw <- spread (df,
key = code,
value = value)
# rename codes
dfw <- rename(dfw, UIGT = "CHE.1.0.0.0.UIGT")
dfw <- rename(dfw, UBLH = "CHE.1.0.0.0.UBLH")
dfw <- rename(dfw, USGP = "CHE.1.0.0.0.USGP")
dfw <- rename(dfw, UKTGT = "CHE.1.0.0.0.UKTGT")
dfw <- rename(dfw, UUTG = "CHE.1.0.0.0.UUTG")
dfw <- rename(dfw, UBLG = "CHE.1.0.0.0.UBLG")
dfw <- rename(dfw, UXGS = "CHE.1.0.0.0.UXGS")
dfw <- rename(dfw, UMGS = "CHE.1.0.0.0.UMGS")
dfw <- rename(dfw, UBLA = "CHE.1.0.0.0.UBLA")
dfw <- rename(dfw, UVGN = "CHE.1.0.0.0.UVGN")
#Now that the data is ready, we can now determine the macroeconomic sectoral balances.
# (S - I)+ (T - G) + (- CAB) ??? 0
## Public Sector can be found via two methods:
dfw$pub <- dfw$URTG - dfw$UUTG # Revenues - Expenses
dfw$bal
# Now we can calculate the share (in % of GNI)
dfw$priv_bal <- (dfw$priv/dfw$UVGN)*100
colors3 <- c("indianred3", "chartreuse4", "turquoise3")
plot_3sectors <- ggplot() +
geom_bar(data = subset(melted_df, year >= 1995 & year<=2022), aes(x = year, y = value, fill = variable), stat = "identity") +
scale_fill_manual(values = colors3,
labels = c("Private sector", "Public Sector", "Rest of the World")) +
labs(x = "Year", y = "Net lending - Net borrowing", fill = "Balances") +
theme_minimal() +
#theme(plot.background = element_rect(fill = "white")) +
scale_x_continuous(breaks = seq(1995, 2022, by = 5)) +
theme(legend.position = "bottom") +
guides(fill = guide_legend(nrow=1)) +
labs(title = "Sectoral balances",
subtitle = "Switzerland, 1995-2022",
caption = "Source: AMECO")
print(plot_3sectors)
View(dfw)
plot_3sectors <- ggplot() +
geom_bar(data = subset(melted_df, year >= 1995 & year<=2022), aes(x = year, y = value, fill = variable), stat = "identity") +
scale_fill_manual(values = colors3,
labels = c("Private sector", "Public Sector", "Rest of the World")) +
labs(x = "Year", y = "Net lending - Net borrowing", fill = "Balances") +
#theme_minimal() +
theme(plot.background = element_rect(fill = "white")) +
scale_x_continuous(breaks = seq(1995, 2022, by = 5)) +
theme(legend.position = "bottom") +
guides(fill = guide_legend(nrow=1)) +
labs(title = "Sectoral balances",
subtitle = "Switzerland, 1995-2022",
caption = "Source: AMECO")
print(plot_3sectors)
plot_3sectors <- ggplot() +
geom_bar(data = subset(melted_df, year >= 1995 & year<=2022), aes(x = year, y = value, fill = variable), stat = "identity") +
scale_fill_manual(values = colors3,
labels = c("Private sector", "Public Sector", "Rest of the World")) +
labs(x = "Year", y = "Net lending - Net borrowing", fill = "Balances") +
theme_minimal() +
scale_x_continuous(breaks = seq(1995, 2022, by = 5)) +
theme(legend.position = "bottom") +
guides(fill = guide_legend(nrow=1)) +
labs(title = "Sectoral balances",
subtitle = "Switzerland, 1995-2022",
caption = "Source: AMECO")
print(plot_3sectors)
plot_3sectors <- ggplot() +
geom_bar(data = subset(melted_df, year >= 1995 & year<=2022), aes(x = year, y = value, fill = variable), stat = "identity") +
geom_vline(xintercept = 2003) +
scale_fill_manual(values = colors3,
labels = c("Private sector", "Public Sector", "Rest of the World")) +
labs(x = "Year", y = "Net lending - Net borrowing", fill = "Balances") +
theme_minimal() +
scale_x_continuous(breaks = seq(1995, 2022, by = 5)) +
theme(legend.position = "bottom") +
guides(fill = guide_legend(nrow=1)) +
labs(title = "Sectoral balances",
subtitle = "Switzerland, 1995-2022",
caption = "Source: AMECO")
print(plot_3sectors)
plot_3sectors <- ggplot() +
geom_bar(data = subset(melted_df, year >= 1995 & year<=2022), aes(x = year, y = value, fill = variable), stat = "identity") +
geom_vline(xintercept = 2003, linetype = "dotted") + #Added a vertical line for the year of introduction of the debt brake in Switzerland
scale_fill_manual(values = colors3,
labels = c("Private sector", "Public Sector", "Rest of the World")) +
labs(x = "Year", y = "Net lending - Net borrowing", fill = "Balances") +
theme_minimal() +
scale_x_continuous(breaks = seq(1995, 2022, by = 5)) +
theme(legend.position = "bottom") +
guides(fill = guide_legend(nrow=1)) +
labs(title = "Sectoral balances",
subtitle = "Switzerland, 1995-2022",
caption = "Source: AMECO")
print(plot_3sectors)
plot_3sectors <- ggplot() +
geom_bar(data = subset(melted_df, year >= 1995 & year<=2022), aes(x = year, y = value, fill = variable), stat = "identity") +
geom_vline(xintercept = 2003, linetype = "dotted", lwd = 1 ) + #Added a vertical line for the year of introduction of the debt brake in Switzerland
scale_fill_manual(values = colors3,
labels = c("Private sector", "Public Sector", "Rest of the World")) +
labs(x = "Year", y = "Net lending - Net borrowing", fill = "Balances") +
theme_minimal() +
scale_x_continuous(breaks = seq(1995, 2022, by = 5)) +
theme(legend.position = "bottom") +
guides(fill = guide_legend(nrow=1)) +
labs(title = "Sectoral balances",
subtitle = "Switzerland, 1995-2022",
caption = "Source: AMECO")
print(plot_3sectors)
plot_3sectors <- ggplot() +
geom_bar(data = subset(melted_df, year >= 1995 & year<=2022), aes(x = year, y = value, fill = variable), stat = "identity") +
geom_vline(xintercept = 2003, linetype = "dotted", lwd = 0.8 ) + #Added a vertical line for the year of introduction of the debt brake in Switzerland
scale_fill_manual(values = colors3,
labels = c("Private sector", "Public Sector", "Rest of the World")) +
labs(x = "Year", y = "Net lending - Net borrowing", fill = "Balances") +
theme_minimal() +
scale_x_continuous(breaks = seq(1995, 2022, by = 5)) +
theme(legend.position = "bottom") +
guides(fill = guide_legend(nrow=1)) +
labs(title = "Sectoral balances",
subtitle = "Switzerland, 1995-2022",
caption = "Source: AMECO")
print(plot_3sectors)
dfw$bal
# Now that we have all balances, we can check the equality (S - I)+ (T - G) + (- CAB) ??? 0
dfw$bal <- dfw$priv + dfw$pub + dfw$row
dfw$bal
dfw$balances
dfw$balances <- dfw$priv_bal + dfw$pub_bal + dfw$row_bal
# clean environment
rm(list=ls())
# Load data
load("path/sectoral_balances/ameco.RData")
# Load data
load("ameco.RData")
# Extract data for Switzerland (CHE)
ch <- subset(ameco, country == "Switzerland")
UBLC <- subset(ch, code == "CHE.1.0.0.0.UBLC")
UBLH <- subset(ch, code == "CHE.1.0.0.0.UBLH")
URTG <- subset(ch, code == "CHE.1.0.0.0.URTG")
UUTG <- subset(ch, code == "CHE.1.0.0.0.UUTG")
UBLG <- subset(ch, code == "CHE.1.0.0.0.UBLG")
UXGS <- subset(ch, code == "CHE.1.0.0.0.UXGS")
UMGS <- subset(ch, code == "CHE.1.0.0.0.UMGS")
UBLA <- subset(ch, code == "CHE.1.0.0.0.UBLA")
UVGN <- subset(ch, code == "CHE.1.0.0.0.UVGN")
# Merge them into one dataframe
df <- rbind(UBLC, UBLH,URTG, UUTG, UBLG, UXGS, UMGS, UBLA, UVGN)
# Select vars
myvars <- c("year", "code", "value")
df <- df[myvars]
# Long to wide
dfw <- spread (df,
key = code,
value = value)
# rename codes
dfw <- rename(dfw, UIGT = "CHE.1.0.0.0.UIGT")
dfw <- rename(dfw, UBLC = "CHE.1.0.0.0.UBLC")
dfw <- rename(dfw, UBLH = "CHE.1.0.0.0.UBLH")
dfw <- rename(dfw, USGP = "CHE.1.0.0.0.USGP")
dfw <- rename(dfw, OIST = "CHE.1.0.0.0.OIST")
dfw <- rename(dfw, UKTGT = "CHE.1.0.0.0.UKTGT")
dfw <- rename(dfw, URTG = "CHE.1.0.0.0.URTG")
dfw <- rename(dfw, UUTG = "CHE.1.0.0.0.UUTG")
dfw <- rename(dfw, UBLG = "CHE.1.0.0.0.UBLG")
dfw <- rename(dfw, UXGS = "CHE.1.0.0.0.UXGS")
dfw <- rename(dfw, UMGS = "CHE.1.0.0.0.UMGS")
dfw <- rename(dfw, UBLA = "CHE.1.0.0.0.UBLA")
dfw <- rename(dfw, UVGN = "CHE.1.0.0.0.UVGN")
#Now that the data is ready, we can now determine the macroeconomic sectoral balances.
# (S - I)+ (T - G) + (- CAB) ??? 0
## Public Sector can be found via two methods:
dfw$pub <- dfw$URTG - dfw$UUTG # Revenues - Expenses
# Or use Net lending - Net borrowing of public sector (UBLG)
dfw$pub <- dfw$UBLG
## Rest of the World
# According to Mitchell, Wray and Watts (2019), CAB = Exports - Imports + Foreign Net Income
# Note that row_bal is negative
dfw$row <- dfw$UBLA  * -1
dfw$row
# Note that the sign of pub_bal is inversed, since the deficit of the public sector is the surplus of the private sector
dfw$priv <- (dfw$pub *-1) - dfw$row
# Now that we have all balances, we can check the equality (S - I)+ (T - G) + (- CAB) ??? 0
dfw$bal <- dfw$priv + dfw$pub + dfw$row
dfw$bal
# Now we can calculate the share (in % of GNI)
dfw$priv_bal <- (dfw$priv/dfw$UVGN)*100
dfw$pub_bal <- (dfw$pub/dfw$UVGN)*100
dfw$row_bal <- (dfw$row/dfw$UVGN) *100
dfw$balances <- dfw$priv_bal + dfw$pub_bal + dfw$row_bal
dfw$balances
# Prepare the data for plotting for 3 sectors
melted_df <- dfw %>%
select(year, priv_bal, pub_bal, row_bal) %>%
gather(key = "variable", value = "value", -year)
colors3 <- c("indianred3", "chartreuse4", "turquoise3")
plot_3sectors <- ggplot() +
geom_bar(data = subset(melted_df, year >= 1995 & year<=2022), aes(x = year, y = value, fill = variable), stat = "identity") +
geom_vline(xintercept = 2003, linetype = "dotted", lwd = 0.8) + #Added a vertical line for the year of introduction of the debt brake in Switzerland
scale_fill_manual(values = colors3,
labels = c("Private sector", "Public Sector", "Rest of the World")) +
labs(x = "Year", y = "Net lending - Net borrowing", fill = "Balances") +
theme_minimal() +
scale_x_continuous(breaks = seq(1995, 2022, by = 5)) +
theme(legend.position = "bottom") +
guides(fill = guide_legend(nrow=1)) +
labs(title = "Sectoral balances",
subtitle = "Switzerland, 1995-2022",
caption = "Source: AMECO")
print(plot_3sectors)
UBLC <- subset(ch, code == "CHE.1.0.0.0.UBLC")
UBLH <- subset(ch, code == "CHE.1.0.0.0.UBLH")
URTG <- subset(ch, code == "CHE.1.0.0.0.URTG")
UUTG <- subset(ch, code == "CHE.1.0.0.0.UUTG")
UBLG <- subset(ch, code == "CHE.1.0.0.0.UBLG")
UXGS <- subset(ch, code == "CHE.1.0.0.0.UXGS")
UMGS <- subset(ch, code == "CHE.1.0.0.0.UMGS")
UBLA <- subset(ch, code == "CHE.1.0.0.0.UBLA")
UVGN <- subset(ch, code == "CHE.1.0.0.0.UVGN")
# Merge them into one dataframe
df <- rbind(UBLC, UBLH,URTG, UUTG, UBLG, UXGS, UMGS, UBLA, UVGN)
# Select vars
myvars <- c("year", "code", "value")
df <- df[myvars]
# Long to wide
dfw <- spread (df,
key = code,
value = value)
# rename codes
dfw <- rename(dfw, UIGT = "CHE.1.0.0.0.UIGT")
dfw <- rename(dfw, UBLC = "CHE.1.0.0.0.UBLC")
dfw <- rename(dfw, UBLH = "CHE.1.0.0.0.UBLH")
dfw <- rename(dfw, USGP = "CHE.1.0.0.0.USGP")
dfw <- rename(dfw, OIST = "CHE.1.0.0.0.OIST")
dfw <- rename(dfw, UKTGT = "CHE.1.0.0.0.UKTGT")
dfw <- rename(dfw, URTG = "CHE.1.0.0.0.URTG")
dfw <- rename(dfw, UUTG = "CHE.1.0.0.0.UUTG")
dfw <- rename(dfw, UBLG = "CHE.1.0.0.0.UBLG")
dfw <- rename(dfw, UXGS = "CHE.1.0.0.0.UXGS")
dfw <- rename(dfw, UMGS = "CHE.1.0.0.0.UMGS")
dfw <- rename(dfw, UBLA = "CHE.1.0.0.0.UBLA")
dfw <- rename(dfw, UVGN = "CHE.1.0.0.0.UVGN")
#Now that the data is ready, we can now determine the macroeconomic sectoral balances.
# (S - I)+ (T - G) + (- CAB) ??? 0
## Public Sector can be found via two methods:
dfw$pub <- dfw$URTG - dfw$UUTG # Revenues - Expenses
# Or use Net lending - Net borrowing of public sector (UBLG)
dfw$pub <- dfw$UBLG
## Rest of the World
# According to Mitchell, Wray and Watts (2019), CAB = Exports - Imports + Foreign Net Income
# Note that row_bal is negative
dfw$row <- dfw$UBLA  * -1
dfw$row
# Note that the sign of pub_bal is inversed, since the deficit of the public sector is the surplus of the private sector
dfw$priv <- (dfw$pub *-1) - dfw$row
# Now that we have all balances, we can check the equality (S - I)+ (T - G) + (- CAB) ??? 0
dfw$bal <- dfw$priv + dfw$pub + dfw$row
dfw$bal
# Now we can calculate the share (in % of GNI)
dfw$priv_bal <- (dfw$priv/dfw$UVGN)*100
dfw$pub_bal <- (dfw$pub/dfw$UVGN)*100
dfw$row_bal <- (dfw$row/dfw$UVGN) *100
dfw$balances <- dfw$priv_bal + dfw$pub_bal + dfw$row_bal
dfw$balances
# Note that the sign of pub_bal is inversed, since the deficit of the public sector is the surplus of the private sector
dfw$priv <- (dfw$pub *-1) - dfw$row
# Now that we have all balances, we can check the equality (S - I)+ (T - G) + (- CAB) ??? 0
dfw$bal <- dfw$priv + dfw$pub + dfw$row
dfw$bal
head(dfw$bal)
dfw$balances
dfw$bal
ggsave("sectoral_balances_che")
ggsave("sectoral_balances_che", width = 15, height = 10, units = "cm")
plot_3sectors <- ggplot() +
geom_bar(data = subset(melted_df, year >= 1995 & year<=2022), aes(x = year, y = value, fill = variable), stat = "identity") +
geom_vline(xintercept = 2003, linetype = "dotted", lwd = 0.8) + #Added a vertical line for the year of introduction of the debt brake in Switzerland
scale_fill_manual(values = colors3,
labels = c("Private sector", "Public Sector", "Rest of the World")) +
labs(x = "Year", y = "Net lending - Net borrowing", fill = "Balances") +
theme_minimal() +
scale_x_continuous(breaks = seq(1995, 2022, by = 5)) +
theme(legend.position = "bottom") +
guides(fill = guide_legend(nrow=1)) +
labs(title = "Sectoral balances",
subtitle = "Switzerland, 1995-2022",
caption = "Source: AMECO")
print(plot_3sectors)
ggsave("sectoral_balances_che", width = 15, height = 10, units = "cm")
ggsave("sectoral_balances_che.png", width = 15, height = 10, units = "cm")
ggsave("sectoral_balances_che.pdf", width = 15, height = 10, units = "cm")
ggsave("sectoral_balances_che.jpg", width = 15, height = 10, units = "cm")
ggsave("sectoral_balances_che.jpg", width = 15, height = 15, units = "cm")
ggsave("sectoral_balances_che.jpg", width = 18, height = 15, units = "cm")
plot_3sectors <- ggplot() +
geom_bar(data = subset(melted_df, year >= 1995 & year<=2022), aes(x = year, y = value, fill = variable), stat = "identity") +
geom_vline(xintercept = 2003, linetype = "dotted", lwd = 0.8) + #Added a vertical line for the year of introduction of the debt brake in Switzerland
scale_fill_manual(values = colors3,
labels = c("Private sector", "Public Sector", "Rest of the World")) +
labs(x = "Year", y = "Net lending - Net borrowing", fill = "Balances") +
theme_minimal() +
scale_x_continuous(breaks = seq(1995, 2022, by = 5)) +
theme(legend.position = "bottom") +
guides(fill = guide_legend(nrow=1)) +
labs(title = "Sectoral balances",
subtitle = "Switzerland, 1995-2022",
caption = "Source: AMECO. By @RomainDsgz")
print(plot_3sectors)
ggsave("sectoral_balances_che.jpg", width = 18, height = 15, units = "cm")
ggsave("3sectors_balances_CHE.jpg", width = 18, height = 15, units = "cm")
# clean environment
rm(list=ls())
# Obtaining and cleaning the data
# Manually download .txt zip from https://ec.europa.eu/info/business-economy-euro/indicators-statistics/economic-databases/macro-economic-database-ameco/download-annual-data-set-macro-economic-database-ameco_en
#
files <- dir("ameco0", ".TXT", full.names = TRUE)
# Load packages for data extraction
library(dplyr)
library(tidyr)
library(tibble)
# Read files, bind together, clean, save
all_files <- lapply(files, function(file) {
read.table(file, TRUE, ";", fill = TRUE,
stringsAsFactors = FALSE, strip.white = TRUE)
})
ameco <- do.call(rbind, all_files)
ameco <- tibble::as_tibble(ameco)
#Drop stray/empty last column
ameco <- ameco[, -ncol(ameco)]
names(ameco) <- tolower(names(ameco))
# Extract short country names
ameco$cntry <- regmatches(ameco$code, regexpr("^[[:alnum:]+]", ameco$code))
# Convert to long format
ameco <- gather(ameco, key = year, value = value, starts_with("x"))
ameco$year <- gsub("x", "", ameco$year)
ameco$year <- as.numeric(ameco$year)
ameco$value <- suppressWarnings(as.numeric(ameco$value))
# Save prepared data
save(ameco, file = "ameco.RData",
compress = "xz")
# Load packages for analysis
library(ggplot2)
library(reshape2)
# Load data
load("ameco.RData")
# Extract data for Switzerland (CHE)
ch <- subset(ameco, country == "Switzerland")
UBLC <- subset(ch, code == "CHE.1.0.0.0.UBLC")
UBLH <- subset(ch, code == "CHE.1.0.0.0.UBLH")
URTG <- subset(ch, code == "CHE.1.0.0.0.URTG")
UUTG <- subset(ch, code == "CHE.1.0.0.0.UUTG")
UBLG <- subset(ch, code == "CHE.1.0.0.0.UBLG")
UXGS <- subset(ch, code == "CHE.1.0.0.0.UXGS")
UMGS <- subset(ch, code == "CHE.1.0.0.0.UMGS")
UBLA <- subset(ch, code == "CHE.1.0.0.0.UBLA")
UVGN <- subset(ch, code == "CHE.1.0.0.0.UVGN")
# Merge them into one dataframe
df <- rbind(UBLC, UBLH,URTG, UUTG, UBLG, UXGS, UMGS, UBLA, UVGN)
# Select vars
myvars <- c("year", "code", "value")
df <- df[myvars]
# Long to wide
dfw <- spread (df,
key = code,
value = value)
# rename codes
dfw <- rename(dfw, UBLC = "CHE.1.0.0.0.UBLC")
dfw <- rename(dfw, UBLH = "CHE.1.0.0.0.UBLH")
dfw <- rename(dfw, URTG = "CHE.1.0.0.0.URTG")
dfw <- rename(dfw, UUTG = "CHE.1.0.0.0.UUTG")
dfw <- rename(dfw, UBLG = "CHE.1.0.0.0.UBLG")
dfw <- rename(dfw, UXGS = "CHE.1.0.0.0.UXGS")
dfw <- rename(dfw, UMGS = "CHE.1.0.0.0.UMGS")
dfw <- rename(dfw, UBLA = "CHE.1.0.0.0.UBLA")
dfw <- rename(dfw, UVGN = "CHE.1.0.0.0.UVGN")
## Public Sector can be found via two methods:
dfw$pub <- dfw$URTG - dfw$UUTG # Revenues - Expenses
# Or use Net lending - Net borrowing of public sector (UBLG)
dfw$pub <- dfw$UBLG
## Rest of the World
# According to Mitchell, Wray and Watts (2019), CAB = Exports - Imports + Foreign Net Income
# Note that row_bal nets tp be expressed as -CAB
dfw$row <- dfw$UBLA  * (-1)
dfw$row
# Note that the sign of pub_bal is inversed, since the deficit of the public sector is the surplus of the private sector
dfw$priv <- (dfw$pub *(-1)) - dfw$row
# Now that we have all balances, we can check the equality (S - I)+ (T - G) + (- CAB) ??? 0
dfw$bal <- dfw$priv + dfw$pub + dfw$row
dfw$bal
head(dfw$bal)
# Now we can calculate the share (in % of GNI)
dfw$priv_bal <- (dfw$priv/dfw$UVGN)*100
dfw$pub_bal <- (dfw$pub/dfw$UVGN)*100
dfw$row_bal <- (dfw$row/dfw$UVGN) *100
dfw$balances <- dfw$priv_bal + dfw$pub_bal + dfw$row_bal
dfw$balances
# Prepare the data for plotting for 3 sectors
melted_df <- dfw %>%
select(year, priv_bal, pub_bal, row_bal) %>%
gather(key = "variable", value = "value", -year)
colors3 <- c("indianred3", "chartreuse4", "turquoise3")
plot_3sectors <- ggplot() +
geom_bar(data = subset(melted_df, year >= 1995 & year<=2022), aes(x = year, y = value, fill = variable), stat = "identity") +
geom_vline(xintercept = 2003, linetype = "dotted", lwd = 0.8) + #Added a vertical line for the year of introduction of the debt brake in Switzerland
scale_fill_manual(values = colors3,
labels = c("Private sector", "Public Sector", "Rest of the World")) +
labs(x = "Year", y = "Net lending - Net borrowing", fill = "Balances") +
theme_minimal() +
scale_x_continuous(breaks = seq(1995, 2022, by = 5)) +
theme(legend.position = "bottom") +
guides(fill = guide_legend(nrow=1)) +
labs(title = "Sectoral balances",
subtitle = "Switzerland, 1995-2022",
caption = "Source: AMECO. By @RomainDsgz")
print(plot_3sectors)
plot_3sectors <- ggplot() +
geom_bar(data = subset(melted_df, year >= 1995 & year<=2025), aes(x = year, y = value, fill = variable), stat = "identity") +
geom_vline(xintercept = 2003, linetype = "dotted", lwd = 0.8) + #Added a vertical line for the year of introduction of the debt brake in Switzerland
scale_fill_manual(values = colors3,
labels = c("Private sector", "Public Sector", "Rest of the World")) +
labs(x = "Year", y = "Net lending - Net borrowing", fill = "Balances") +
theme_minimal() +
scale_x_continuous(breaks = seq(1995, 2025, by = 5)) +
theme(legend.position = "bottom") +
guides(fill = guide_legend(nrow=1)) +
labs(title = "Sectoral balances",
subtitle = "Switzerland, 1995-2025",
caption = "Source: AMECO. By @RomainDsgz")
print(plot_3sectors)
